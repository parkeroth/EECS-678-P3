# This makefile makes an assumption regarding the histograms with
# which it is working. It will not likely behave as expected if it is
# not ran on histograms generated by nachos running the program
# 'nice_free'

lasts: prep
	$(foreach n,$(NAMS), \
	 ln -s $(word $(words $(shell ls $(n)@*.inactive.histo)),$(shell ls $(n)@*.inactive.histo)) $n.last.inactive.histo; \
	 ln -s $(word $(words $(shell ls $(n)@*.active.histo)),$(shell ls $(n)@*.active.histo)) $n.last.active.histo; \
	)
	


TIDS=T-2 T-3 T-4 T-5
NAMS=A C D B
prep:
	-\rm T-1\@tick*.{inactive,active}.histo
	-$(foreach n, 1 2 3 4, \
	   $(foreach f, $(shell ls -1 $(word $(n),$(TIDS))*.{ina,a}ctive.histo), \
	     mv $(f) $(subst $(word $(n),$(TIDS)),$(word $(n),$(NAMS)),$(f)); \
	    ) \
	  )
